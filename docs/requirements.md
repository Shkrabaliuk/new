# Requirements (MVP v0)

Дата: 2026-02-13

## 1. Контекст і ціль

Проєкт: **text-first CMS** з “чистим аркушем”, автоматичною типографікою та файловим збереженням.

Ціль MVP: дати автору можливість **писати Markdown-подібний текст**, мати **надійне автозбереження у файли**, **базовий рендер у HTML**, та **навігацію/стрічку матеріалів** — без важких функцій семантичного “склеювання”.

---

## 2. Межі MVP (in/out)

### 2.1 In (перший реліз)

**Авторинг**
- Мінімальний редактор “чистий аркуш” (textarea/monospace або базовий ProseMirror/CodeMirror — без toolbar).
- Підтримка перетягування зображень (drag&drop) у редактор:
  - збереження файлу в `assets/`
  - вставка посилання у текст (Markdown image або службовий блок).

**Текстова обробка**
- Авто-типографіка (мінімум):
  - заміна лапок на «…» (для uk/ru) або відповідний стиль за конфігом
  - тире: `--` → `—` (em dash) за правилами
  - нерозривні пробіли для коротких прийменників/сполучників (налаштовуваний список)
- Нормалізація нового рядка та пробілів (стабільний детермінований результат).

**Структура і рендер**
- Інференс структури (мінімум):
  - “короткий рядок + порожній рядок” → заголовок H2
  - списки: `1.` / `-` / `*`
- Parser/render pipeline (див. docs/architecture.md):
  - raw text → normalization → typography → structure inference → block model → HTML
- Базовий рендер HTML + CSS-шаблон (мінімально читабельний).

**Зберігання**
- Файлова модель:
  - контент зберігається як `content/<slug>.md`
  - метадані — у YAML front matter або окремому `.json` (див. ADR-0001)
  - ассети — у `assets/<slug>/...`
- Автозбереження “на кожну зміну” з дебаунсом (наприклад 300–800 мс) + журнал відновлення (backup/revision).

**Навігація**
- Список матеріалів (index): сортування за датою/оновленням, фільтр за тегами.
- Перехід між матеріалами:
  - “попередній/наступний”
  - базовий “read next” за тегами без семантичних векторів (heuristics).

### 2.2 Out (не в MVP)

- Повноцінний “Infinite Narrative” з динамічним підвантаженням і “проявленням” наступного поста.
- Семантичне склеювання на векторах/LLM, embeddings, ANN-індекси.
- Колаборація в реальному часі, ролі/права, multi-user.
- Коментарі, лайки, реакції, інтеграції соцмереж.
- Розширений редактор (таблиці, складні layout-блоки, дизайнерські шаблони).
- Публічний хостинг/деплой-платформа (можна як окремий етап).

---

## 3. Функціональні вимоги (FR)

### FR-1. Редактор “чистий аркуш”
- **FR-1.1** Редактор відкриває і редагує документ із файлу.
- **FR-1.2** Немає панелей форматування (мінімальний UI).
- **FR-1.3** Підтримка drag&drop для зображень.

### FR-2. Авто-типографіка
- **FR-2.1** Нормалізація пробілів і переносів рядків.
- **FR-2.2** Правила лапок/тире/нерозривних пробілів застосовуються детерміновано.
- **FR-2.3** Є режим “preview diff” (опційно): показати що змінилось у тексті.

### FR-3. Автозбереження у файли
- **FR-3.1** Автозбереження після кожної зміни (з дебаунсом).
- **FR-3.2** При аварійному закритті вкладки дані відновлюються.
- **FR-3.3** Файлова структура переносима (копіювання папки = перенос сайту).

### FR-4. Рендер у HTML
- **FR-4.1** Є пайплайн перетворення (див. pipeline spec).
- **FR-4.2** Рендер підтримує базові блоки: абзац, H2, списки, зображення, code block.
- **FR-4.3** Рендер не ламається на “службових конструкціях” (marginalia, slash).

### FR-5. Навігація
- **FR-5.1** Сторінка списку матеріалів.
- **FR-5.2** Сторінка документа з next/prev.
- **FR-5.3** Базовий “related” за тегами (heuristics).

---

## 4. Нефункціональні вимоги (NFR)

### NFR-1. Продуктивність рендерингу
- Рендер документа до 20k символів у preview: **≤ 50 мс** на середньому ноутбуці (ціль).
- Інкрементальні оновлення (мінімум: дебаунс, кешування проміжних результатів).

### NFR-2. Офлайн-робота
- Редактор працює без інтернету.
- Вся логіка локальна (окрім опційної синхронізації Git/Dropbox).

### NFR-3. Відмовостійкість автозбереження
- Якщо запис файлу не вдався, система:
  - зберігає в локальний recovery log
  - показує ненав’язливий статус “not saved”
  - ретраїть запис.
- Автозбереження не блокує введення.

### NFR-4. Переносимість формату
- Контент — читабельні текстові файли.
- Метадані — стандартний формат (YAML/JSON).
- Відсутність залежності від БД як єдиного джерела істини.

### NFR-5. Тестованість і детермінізм
- Трансформації тексту повинні бути детерміновані й покриті тестами (golden tests).
- Всі правила типографіки задокументовані.

---

## 5. Acceptance Criteria (MVP)

- Можна створити документ, написати текст, зберегти у `content/*.md`.
- Авто-типографіка застосовується і не “ламає” зміст.
- Зображення додається drag&drop і рендериться у preview.
- Є сторінка списку документів і переходи next/prev.
